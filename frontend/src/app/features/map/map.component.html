<div class="map-screen-container">
  <img src="/assets/img/bg-map.png" class="map-background" />
  <div class="screen-fade"></div>

  <!-- Banner con ciudad actual -->
  <div class="map-banner">
    <span class="map-banner-text">Ciudad actual: {{ currentCity }}</span>
  </div>

  <!-- Renderizado de ciudades -->
  <ng-container *ngFor="let city of cities">
    <button
      class="map-city"
      [class.available]="city.available"
      [class.current-city]="city.name === currentCity"
      [ngStyle]="{ top: city.y + '%', left: city.x + '%' }"
      (click)="city.available && openPopup(city)"
    >
      <img src="/assets/icons/city-icon.png" alt="Ciudad" />
      <span class="city-name">{{ city.name }}</span>
    </button>
  </ng-container>

  <!-- Botón volver -->
  <button class="back-button" (click)="goBack()">⬅ Volver</button>
</div>

<!-- Popup de rutas -->
<div class="city-popup-overlay" *ngIf="selectedCity">
  <div class="city-popup">
    <h2>{{ selectedCity.name }}</h2>

    <div class="routes-container">
      <div *ngFor="let route of selectedCity.routes" class="route-card">
        <p><strong>{{ route.type }}</strong></p>
        <p *ngIf="route.cause">Causa: {{ route.cause }}</p>
        <p>Tiempo estimado: {{ route.time }}</p>
        <p *ngIf="route.damage > 0">Daño estimado: -{{ route.damage }} puntos de vida</p>
        <button class="btn-travel" (click)="travelTo(selectedCity)">Viajar</button>
      </div>
    </div>

    <button class="btn-close" (click)="closePopup()">✖</button>
  </div>
</div>
